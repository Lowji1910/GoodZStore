╔══════════════════════════════════════════════════════════════╗
║          HƯỚNG DẪN CHẠY NHANH - AI CHATBOT GOODZSTORE        ║
╚══════════════════════════════════════════════════════════════╝

📌 CẬP NHẬT: Đã thêm fallback mechanism - Chatbot vẫn hoạt động
   dù Gemini API có lỗi. Hệ thống sẽ tự động trả về response!

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🚀 BƯỚC 1: CÀI ĐẶT (Chỉ làm 1 lần)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. Mở Command Prompt (CMD)

2. Di chuyển vào thư mục:
   cd D:\BaiHoc\ĐACN\GoodZStore\ai_server

3. Cài thư viện Python:
   pip install flask pymysql python-dotenv google-generativeai flask-cors

4. Tạo database tables:
   - Mở phpMyAdmin: http://localhost/phpmyadmin
   - Chọn database: goodzstore
   - Tab SQL → Import file: 
     D:\BaiHoc\ĐACN\GoodZStore\migrations\create_ai_tables.sql
   - Click Go

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

▶️ BƯỚC 2: CHẠY SERVER
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

CÁCH 1 (Đơn giản): Double-click file này
   📁 D:\BaiHoc\ĐACN\GoodZStore\ai_server\start_server.bat

CÁCH 2 (Command line):
   cd D:\BaiHoc\ĐACN\GoodZStore\ai_server
   python app.py

✅ Thấy dòng này = Thành công:
   * Running on http://127.0.0.1:5000

⚠️ GIỮ CỬA SỔ CMD MỞ, KHÔNG TẮT!

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🧪 BƯỚC 3: TEST
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Mở CMD MỚI (giữ cái cũ chạy server):

   cd D:\BaiHoc\ĐACN\GoodZStore\ai_server
   python test_api.py

Kết quả mong đợi:
   ✅ TEST 1: Chat Endpoint - Size Question → Status Code: 200
   ✅ TEST 2: Chat Endpoint - Promo Question → Status Code: 200
   ✅ TEST 3: Chat Endpoint - Style Advice → Status Code: 200
   ✅ TEST 4: Size Endpoint → Status Code: 200

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🌐 BƯỚC 4: TEST TRÊN WEBSITE
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. Bật XAMPP (Apache phải đang chạy)

2. Mở trình duyệt, vào:
   http://localhost/GoodZStore/Views/Users/product.php?id=1

3. Cuộn xuống tìm: "Trợ lý AI - Tư vấn thời trang"

4. Thử chat:
   - "Tôi cao 170cm, nên mặc size nào?"
   - "Có mã giảm giá không?"
   - "Áo này phối với quần gì đẹp?"

5. Click "Gửi" và chờ AI trả lời (3-5 giây)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

👨‍💼 BƯỚC 5: ADMIN PANEL (Tùy chọn)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. Đăng nhập admin:
   http://localhost/GoodZStore/Views/Users/login.php

2. Vào trang quản lý AI:
   http://localhost/GoodZStore/Views/Admins/admin_ai_training.php

3. Xem hội thoại và thêm vào training data

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

❌ XỬ LÝ LỖI
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

LỖI: "ModuleNotFoundError: No module named 'flask'"
→ Chạy: pip install flask pymysql python-dotenv google-generativeai flask-cors

LỖI: "Can't connect to MySQL server"
→ Kiểm tra:
  1. XAMPP MySQL đang chạy?
  2. File .env có đúng không? (DB_USER=root, DB_PASS=)

LỖI: "Table 'ai_conversations' doesn't exist"
→ Import file SQL:
  migrations/create_ai_tables.sql vào phpMyAdmin

LỖI: "Port 5000 already in use"
→ Tắt app đang dùng port 5000:
  netstat -ano | findstr :5000
  taskkill /PID <số_PID> /F

LỖI: "API key not valid" hoặc "models/gemini-xxx not found"
→ Giải pháp:
  1. Cập nhật thư viện: pip install google-generativeai --upgrade
  2. Chạy: python fix_gemini.py (để kiểm tra models)
  3. Restart Flask server
  
  ⚠️ LƯU Ý: Dù Gemini lỗi, chatbot VẪN HOẠT ĐỘNG với fallback!

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📚 TÀI LIỆU CHI TIẾT
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📖 Hướng dẫn đầy đủ tiếng Việt:
   D:\BaiHoc\ĐACN\GoodZStore\HUONG_DAN_CHAY_AI.md

📖 Tóm tắt triển khai (cho báo cáo):
   D:\BaiHoc\ĐACN\GoodZStore\AI_IMPLEMENTATION_SUMMARY.md

📖 API Documentation:
   D:\BaiHoc\ĐACN\GoodZStore\ai_server\README.md

📖 Quick Start:
   D:\BaiHoc\ĐACN\GoodZStore\ai_server\QUICKSTART.md

📖 Deployment Guide:
   D:\BaiHoc\ĐACN\GoodZStore\ai_server\DEPLOYMENT.md

📖 Khắc phục lỗi Gemini:
   D:\BaiHoc\ĐACN\GoodZStore\ai_server\FIX_GEMINI_ERROR.md

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ CHECKLIST
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

□ Python đã cài (python --version)
□ Thư viện đã cài (pip list | findstr flask)
□ MySQL đang chạy (XAMPP)
□ Database tables đã tạo (ai_conversations, ai_training_data)
□ File .env đã cấu hình
□ Flask server chạy thành công (port 5000)
□ Test API pass (python test_api.py)
□ Chatbox hiện trên trang product
□ Chat với AI thành công
□ Admin panel truy cập được

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎯 CÁC FILE QUAN TRỌNG
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Backend:
  ✓ ai_server/app.py              - Flask server chính
  ✓ ai_server/.env                - Cấu hình API key & DB
  ✓ ai_server/requirements.txt    - Dependencies
  ✓ ai_server/test_api.py         - Test script
  ✓ ai_server/start_server.bat    - Chạy nhanh

Database:
  ✓ migrations/create_ai_tables.sql - Tạo bảng

Frontend:
  ✓ Views/Users/product.php       - Trang có chatbox
  ✓ Views/Admins/admin_ai_training.php - Quản lý training

Documentation:
  ✓ CHAY_NGAY.txt                 - File này
  ✓ HUONG_DAN_CHAY_AI.md          - Hướng dẫn đầy đủ
  ✓ AI_IMPLEMENTATION_SUMMARY.md  - Tóm tắt triển khai

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💡 TIPS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. Luôn kiểm tra Flask server đang chạy trước khi test
2. Xem logs trong CMD để debug
3. Refresh trang (Ctrl+F5) nếu thay đổi code
4. Kiểm tra Console browser (F12) nếu chatbox không hoạt động
5. Backup database trước khi thay đổi

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎉 CHÚC BẠN THÀNH CÔNG!
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Nếu gặp vấn đề, đọc file: HUONG_DAN_CHAY_AI.md
Hoặc kiểm tra logs trong terminal Flask server.

Ngày cập nhật: 27/10/2024
Version: 1.0.1 (Fixed Gemini model name)
